@use "../../../styles/variables.scss" as *;
@use "../../../styles/mixins.scss" as *;

/* Top-of-viewport, centered toast */
.flash {
  position: fixed; /* viewport-fixed */
  z-index: var(--flash-z, 2147483647); /* above everything */

  /* 50px below the safe top inset (for iOS notches) */
  top: calc(env(safe-area-inset-top, 0px) + 50px);
  left: 50%;
  transform: translateX(-50%);

  /* Sizing */
  min-width: 300px;
  max-width: min(640px, calc(100vw - 2rem));

  /* Keep your visuals */
  padding: 1rem 2rem;
  border-radius: 8px;
  background: rgba(var(--light-gray), 0.95);
  color: rgb(var(--text));
  border: 1px solid rgba(var(--mask), 0.15);
  box-shadow: var(--box-shadow-medium);
  backdrop-filter: var(--backdrop-filter);
  font-family: var(--font-family-base);
  font-weight: 600;
  text-align: center;
  line-height: 1.25;

  /* Donâ€™t block page interactions except the close button */
  pointer-events: none;

  /* Animations (auto-hide delay set via CSS var, bound in template) */
  --flash-hide-delay: 3s;
  animation:
    flash-slide-in 260ms ease-out,
    flash-fade-out 260ms ease-in var(--flash-hide-delay) forwards;

  /* Optional grid for icon/close slots */
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: .5rem .75rem;

  &__close {
    pointer-events: auto; /* allow clicking the button */
    background: none; border: 0; cursor: pointer;
    font-size: 1.1rem; line-height: 1; opacity: .75; color: inherit;
  }

  /* Variants */
  &--success { background: rgba(20, 157, 72, 0.95); color: rgb(var(--text-mask-dark)); }
  &--error   { background: rgba(220, 53, 69, 0.95); color: #fff; border-color: rgba(220,53,69,0.65); }
  &--warning { background: rgba(221, 191, 24, 0.95);  color: rgb(var(--text-mask-dark)); }
  &--info    { background: rgba(27, 88, 185, 0.95); color: rgb(var(--text)); }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .flash { animation: none; }
}

/* Mobile spacing */
@media (max-width: 480px) {
  .flash {
    min-width: unset;
    padding: .875rem 1rem;
  }
}

/* Optional: stacking multiple toasts (index 0,1,2,...) */
.flash {
  --flash-index: 0; /* set inline per toast if needed */
  top: calc(
    env(safe-area-inset-top, 0px)
    + 50px
    + (var(--flash-index) * 56px)
  );
}
