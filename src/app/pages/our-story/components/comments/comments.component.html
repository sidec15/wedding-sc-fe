<div class="comments-section">
  <!-- Comments List Section -->
  <div class="comments-list-section">
    <h4 class="section-title">
      {{ "our_story.comments.title" | translate }} ({{ comments.length }})
    </h4>

    <div class="comments-list" *ngIf="comments.length > 0">
      <div
        class="comment-item"
        *ngFor="let comment of comments; trackBy: trackByCommentId"
      >
        <div class="comment-header">
          <span class="comment-author">{{ comment.authorName }}</span>
          <span class="comment-date">{{ formatDate(comment.createdAt) }}</span>
        </div>
        <div class="comment-content">
          {{ comment.content }}
        </div>
      </div>
    </div>

    <div class="no-comments" *ngIf="comments.length === 0">
      <p>{{ "our_story.comments.no_comment" | translate }}</p>
    </div>
  </div>

  <!-- Comment Form Section -->
  <div class="comment-form-section">
    <h4 class="section-title">
      {{ "our_story.comments.leave_comment_message" | translate }}
    </h4>

    <form
      [formGroup]="commentForm"
      (ngSubmit)="onSubmit()"
      class="comment-form"
    >
      <div class="form-group">
        <label for="authorName" class="form-label">Nickname *</label>
        <input
          type="text"
          id="authorName"
          formControlName="authorName"
          class="form-input"
          [placeholder]="'our_story.comments.nickname_placeholder' | translate"
          [class.error]="
            commentForm.get('authorName')?.invalid &&
            commentForm.get('authorName')?.touched
          "
        />
        <div
          class="error-message"
          *ngIf="
            commentForm.get('authorName')?.invalid &&
            commentForm.get('authorName')?.touched
          "
        >
          {{ getErrorMessage("authorName") }}
        </div>
      </div>

      <div class="form-group">
        <label for="message"
          >{{ "our_story.comments.comment" | translate }} *</label
        >
        <textarea
          id="message"
          formControlName="message"
          class="form-textarea"
          [placeholder]="'our_story.comments.write_comment' | translate"
          rows="4"
          [attr.maxlength]="maxMessageLength"
          [class.error]="
            commentForm.get('message')?.invalid &&
            commentForm.get('message')?.touched
          "
        ></textarea>

        <div class="char-count">
          {{ commentForm.get("message")?.value?.length || 0 }}/{{
            maxMessageLength
          }}
        </div>
        <div
          class="error-message"
          *ngIf="
            commentForm.get('message')?.invalid &&
            commentForm.get('message')?.touched
          "
        >
          {{ getErrorMessage("message") }}
        </div>
      </div>

      <button
        type="submit"
        class="submit-btn"
        [disabled]="commentForm.invalid || isSubmitting"
      >
        <span *ngIf="!isSubmitting">{{
          "our_story.comments.submit" | translate
        }}</span>
        <span *ngIf="isSubmitting">{{
          "our_story.comments.submitting" | translate
        }}</span>
      </button>
    </form>
  </div>
</div>
