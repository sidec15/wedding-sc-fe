<section class="contact-form">
  @let isMobile = (isMobile$ | async) ?? false;

  <h2>{{ "contact_us.contact_form.title" | translate }}</h2>

  <!-- Chiara image for mobile -->
  @if (isMobile) {
  <div class="contact-form-image chiara">
    <img src="images/comics/comics-02.png" alt="Contact Us Chiara" />
  </div>
  }

  <h3>{{ "contact_us.contact_form.subtitle" | translate }}</h3>
  <p>{{ "contact_us.contact_form.description" | translate }}</p>

  <div class="form-row">
    <!-- Chiara image for desktop -->
    @if (!isMobile) {
    <div class="contact-form-image chiara">
      <img src="images/comics/comics-02.png" alt="Contact Us Chiara" />
    </div>
    }

    <form
      class="contact-form-container"
      [formGroup]="contactForm"
      (ngSubmit)="onSubmit()"
    >
      <!-- Honeypot field -->
      <div class="hidden">
        <input
          type="text"
          formControlName="websiteContactForm"
          autocomplete="off"
        />
      </div>

      <div class="form-group">
        <label for="name"
          >{{ "contact_us.contact_form.name" | translate }} *</label
        >
        <input type="text" id="name" formControlName="name" maxlength="50" />
        @if (contactForm.get('name')?.errors?.['required'] && submitted) {
        <div class="error">
          {{ "contact_us.contact_form.name_required" | translate }}
        </div>
        } @if (contactForm.get('name')?.errors?.['maxlength'] && submitted) {
        <div class="error">
          {{ "contact_us.contact_form.name_too_long" | translate }}
        </div>
        }
      </div>

      <div class="form-group">
        <label for="surname"
          >{{ "contact_us.contact_form.surname" | translate }} *</label
        >
        <input
          type="text"
          id="surname"
          formControlName="surname"
          maxlength="50"
        />
        @if (contactForm.get('surname')?.errors?.['required'] && submitted) {
        <div class="error">
          {{ "contact_us.contact_form.surname_required" | translate }}
        </div>
        } @if (contactForm.get('surname')?.errors?.['maxlength'] && submitted) {
        <div class="error">
          {{ "contact_us.contact_form.surname_too_long" | translate }}
        </div>
        }
      </div>

      <div class="form-group">
        <label for="phone">{{
          "contact_us.contact_form.phone" | translate
        }}</label>
        <input
          type="tel"
          id="phone"
          formControlName="phone"
          placeholder="+39 123 456 7890"
        />
        @if (contactForm.get('phone')?.errors?.['pattern'] && submitted) {
        <div class="error">
          {{ "contact_us.contact_form.phone_invalid" | translate }}
        </div>
        }
      </div>

      <div class="form-group">
        <label for="email">{{
          "contact_us.contact_form.email" | translate
        }}</label>
        <input type="email" id="email" formControlName="email" required />
        @if (contactForm.get('email')?.errors?.['email'] && submitted) {
        <div class="error">
          {{ "contact_us.contact_form.email_invalid" | translate }}
        </div>
        }
      </div>

      <div class="form-group">
        <label for="message">{{ "contact_us.contact_form.message" | translate }} *</label>

        <app-rich-text-editor
          id="message"
          formControlName="message"
          [placeholder]="'our_story.comments.write_comment' | translate"
          [emojiEnabled]="true"
          (lengthChange)="messageCharCount = $event"
          [error]="!!(messageControl?.invalid && messageControl?.touched)"
        >
        </app-rich-text-editor>

        <div class="char-count">
          {{ messageCharCount || 0 }}/{{ maxMessageLength }}
        </div>

        @if (contactForm.get('message')?.invalid &&
        contactForm.get('message')?.touched) {
        <div class="error-message">{{ getErrorMessage("message") }}</div>
        }
      </div>

      <app-security-consent
        [form]="contactForm"
        [submitted]="submitted"
        captchaControlName="captchaContactForm"
        privacyControlName="privacyContactForm"
      />

      <button class="btn" type="submit">
        {{ "contact_us.contact_form.submit" | translate }}
      </button>
    </form>

    <!-- Simone image for desktop -->
    @if (!isMobile) {
    <div class="contact-form-image simone">
      <img src="images/comics/comics-03.png" alt="Contact Us Simone" />
    </div>
    }
  </div>

  <!-- Simone image for mobile -->
  @if (isMobile) {
  <div class="contact-form-image simone">
    <img src="images/comics/comics-03.png" alt="Contact Us Simone" />
  </div>
  }
</section>
